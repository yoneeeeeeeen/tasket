h1.text-center.my-5 商品計算履歴一覧

.container.mt-4
  .row.mb-3
    .col-12.d-flex.justify-content-between.align-items-center
      h3.mb-0
        i.fas.fa-history.me-2
        | 保存した計算履歴
      = link_to icon_calculate_products_path, class: "btn btn-primary" do
        i.fas.fa-calculator.me-1
        | 商品計算に戻る

  - if @histories.any?
    / デスクトップ: テーブル表示
    .row.d-none.d-lg-block
      .col-12
        .table-responsive
          table.table.table-hover.align-middle
            thead.table-light
              tr
                th.text-center タイトル
                th.text-center 合計金額
                th.text-center 商品数
                th.text-center 保存日時
                th.text-center 操作
            tbody
              - @histories.each do |history|
                tr
                  td
                    = link_to history.title, product_calculation_history_path(history), class: "text-decoration-none fw-bold"
                  td.text-end.text-success.fw-bold
                    = number_to_currency(history.total_amount, unit: "¥", precision: 0)
                  td.text-center
                    span.badge.bg-info.text-dark
                      = history.items.count
                      | 品目
                  td.text-center
                    = history.saved_at.strftime('%Y年%m月%d日 %H:%M')
                  td.text-center
                    .d-flex.gap-2.justify-content-center
                      = link_to product_calculation_history_path(history), class: "btn btn-sm btn-outline-primary" do
                        i.fas.fa-eye.me-1
                        | 詳細
                      = button_to product_calculation_history_path(history), method: :delete, data: { confirm: '本当に削除しますか？' }, class: "btn btn-sm btn-outline-danger" do
                        i.fas.fa-trash.me-1
                        | 削除

    / タブレット・モバイル: カード表示
    .row.d-lg-none
      .col-12
        - @histories.each do |history|
          .card.mb-3.shadow-sm
            .card-body
              .d-flex.justify-content-between.align-items-start.mb-2
                h5.card-title.mb-0.flex-grow-1
                  = link_to history.title, product_calculation_history_path(history), class: "text-decoration-none"
                span.badge.bg-info.text-dark.ms-2
                  = history.items.count
                  | 品目
              .row.g-2.mb-3
                .col-6
                  .text-muted.small 合計金額
                  .text-success.fw-bold.fs-5
                    = number_to_currency(history.total_amount, unit: "¥", precision: 0)
                .col-6
                  .text-muted.small 保存日時
                  .text-dark
                    = history.saved_at.strftime('%Y/%m/%d')
                    br
                    = history.saved_at.strftime('%H:%M')
              .d-flex.gap-2.flex-wrap
                = link_to product_calculation_history_path(history), class: "btn btn-sm btn-outline-primary flex-fill" do
                  i.fas.fa-eye.me-1
                  | 詳細
                = button_to product_calculation_history_path(history), method: :delete, data: { confirm: '本当に削除しますか？' }, class: "btn btn-sm btn-outline-danger flex-fill" do
                  i.fas.fa-trash.me-1
                  | 削除

    .row.mt-4
      .col-12.d-flex.justify-content-center
        = paginate @histories
  - else
    .row
      .col-12
        .alert.alert-info.text-center
          i.fas.fa-info-circle.me-2
          | まだ保存された計算履歴がありません。商品計算画面で商品を選択して保存してください。
          .mt-3
            = link_to icon_calculate_products_path, class: "btn btn-primary" do
              i.fas.fa-calculator.me-1
              | 商品計算を始める
